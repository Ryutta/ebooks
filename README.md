# スクリーンショット PDF 自動化ツール

このツールは、パソコン画面上の指定された範囲を自動的にスクリーンショット撮影し、それらを1つのPDFファイルにまとめる Python スクリプトです。
電子書籍やスライドなどをページ送りしながら保存したい場合に便利です。

## 特徴

*   **自動撮影**: 指定したページ数分、自動でスクリーンショットを撮影し、キーボードの「右矢印キー」を押してページ送りします。
*   **範囲指定**: マウスカーソルを使って、撮影したい範囲（左上と右下）を直感的に指定できます。
*   **PDF化**: 撮影した画像を自動的に1つのPDFファイルに結合します。

## 必要要件

*   Python 3.x
*   以下のPythonライブラリ:
    *   `pyautogui` (スクリーンショット撮影、キーボード操作用)
    *   `fpdf2` (PDF作成用)

## インストール方法

1.  このリポジトリをクローンまたはダウンロードします。
2.  必要なライブラリをインストールします。

```bash
pip install -r requirements.txt
```

または手動でインストールする場合:

```bash
pip install pyautogui fpdf2
```

### 注意点 (OS別)

*   **macOS**: 初回実行時に「画面収録」と「アクセシビリティ」の許可を求められる場合があります。システム環境設定から許可してください。
*   **Linux**: `scrot` や `python3-tk`, `python3-dev` などのパッケージが必要になる場合があります。エラーが出る場合は以下を試してください。
    ```bash
    sudo apt-get install scrot python3-tk python3-dev
    ```

## 使い道

ターミナル（コマンドプロンプト）から `exec_all.py` を実行します。

### 基本的なコマンド

```bash
python exec_all.py -s <開始ページ番号> -e <終了ページ番号>
```

例: 1ページ目から10ページ目まで撮影する場合

```bash
python exec_all.py -s 1 -e 10
```

### オプション引数

*   `-s`, `--start_page` (必須): 撮影を開始するページ番号（整数）。
*   `-e`, `--end_page` (必須): 撮影を終了するページ番号（整数）。
*   `-o`, `--output_dir`: 画像とPDFの保存先ディレクトリ。デフォルトは現在のディレクトリ (`.`) です。
*   `-c`, `--chapter_name`: 章の名前などを指定すると、ファイル名に付与されます。

例: "Chapter1" という名前で、`output` フォルダに保存する場合

```bash
python exec_all.py -s 1 -e 20 -o ./output -c Chapter1
```

## 実行の流れ

1.  **コマンド実行**: 上記のコマンドを入力して実行します。
2.  **範囲指定**:
    *   「カーソルをスクショしたい範囲の左上角に合わせてください」と表示され、カウントダウンが始まります（5秒）。
    *   指定したい位置にマウスカーソルを置いて待ちます。
    *   次に「右下角」も同様に指定します。
3.  **ウィンドウ選択**:
    *   「撮影したいウィンドウを選択してください」と表示され、カウントダウンが始まります（5秒）。
    *   撮影対象のウィンドウ（ブラウザやアプリ）をクリックしてアクティブにします。
4.  **自動撮影開始**:
    *   指定した範囲のスクリーンショットが撮影され、右矢印キーが押されます。これを指定ページ数繰り返します。
5.  **PDF作成**:
    *   撮影が完了すると、自動的にPDFが作成され、`pdf` フォルダに保存されます。

## ファイル構成と解説

### `exec_all.py`
このツールのメインスクリプトです。全体のフロー（引数処理 -> 範囲指定 -> 撮影 -> PDF化）を制御します。

### `screenshot.py`
スクリーンショット撮影とページ送りを担当するモジュールです。
*   `decide_capture_region()`: ユーザーに対話的に範囲を指定させます。
*   `capture_screen()`: 指定範囲を撮影し、画像を保存します。

### `image2pdf.py`
画像のPDF変換を担当するモジュールです。
*   `image_to_pdf()`: 指定ディレクトリ内の画像を読み込み、PDFファイルを作成します。`fpdf2` ライブラリを使用しています。

## カスタマイズ

`screenshot.py` 内の以下の変数を変更することで、動作を調整できます。

*   `shot_span = 2`: 撮影ごとの待機時間（秒）。ページ送りが遅い場合は増やしてください。
*   `next_page_key = 'right'`: ページ送りに使うキー。左送りの場合は `'left'` に変更してください。

## トラブルシューティング

*   **画像が真っ黒になる**: 一部のアプリ（著作権保護されたコンテンツなど）ではスクリーンショットがブロックされる場合があります。また、LinuxのWayland環境では正常に動作しないことがあります。
*   **ページ送りがされない**: 対象のウィンドウがアクティブになっていない可能性があります。撮影開始前のカウントダウン中にウィンドウをクリックしてください。
